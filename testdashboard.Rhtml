<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sudanese & Diaspora Owned Businesses Dashboard</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        #map {
            height: 600px; /* Adjust height as needed */
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <h1>Sudanese & Diaspora Owned Businesses and Projects Dashboard</h1>
    <label for="countryDropdown">Select Country:</label>
    <select id="countryDropdown">
        <option value="Sudan">Sudan</option>
        <option value="USA">USA</option>
        <option value="UK">UK</option>
        <!-- Add more countries as needed -->
    </select>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Sample data for businesses
        const top_bus = [
            { name: "Business A", latitude: 15.0, longitude: 30.5, country_of_business_project: "Sudan" },
            { name: "Business B", latitude: 12.5, longitude: 34.5, country_of_business_project: "Sudan" },
            { name: "Business C", latitude: 40.7128, longitude: -74.0060, country_of_business_project: "USA" }, // New York
            { name: "Business D", latitude: 51.5074, longitude: -0.1278, country_of_business_project: "UK" }, // London
        ];

        // Set up the map
        const map = L.map('map').setView([15.0, 30.0], 5); // Centered on Sudan
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: 'Â© OpenStreetMap'
        }).addTo(map);

        // Country zoom configurations
        const countryZoom = {
            Sudan: { coords: [15.0, 30.5], zoom: 5 },
            USA: { coords: [37.1, -95.7], zoom: 4 }, // Centered on USA
            UK: { coords: [55.0, -3.4], zoom: 6 }, // Centered on UK
            // Add more countries with their center coordinates and zoom level
        };

        // Function to update the map based on selected country
        function updateMap(selectedCountry) {
            // Clear existing markers
            map.eachLayer(function (layer) {
                if (layer instanceof L.CircleMarker) {
                    map.removeLayer(layer);
                }
            });

            // Filter businesses by the selected country
            const businessesInCountry = top_bus.filter(business => business.country_of_business_project === selectedCountry);

            // Check if there are businesses to display
            if (businessesInCountry.length > 0) {
                businessesInCountry.forEach(business => {
                    // Create a circular marker for each business
                    const marker = L.circleMarker([business.latitude, business.longitude], {
                        radius: 8, // Adjust radius as needed
                        color: 'blue', // Marker color
                        fillColor: '#30f', // Fill color
                        fillOpacity: 0.5
                    }).addTo(map).bindPopup(business.name); // Add popup with business name
                });
            } else {
                console.warn(`No businesses found for ${selectedCountry}`);
            }

            // Zoom into the selected country
            if (countryZoom[selectedCountry]) {
                const { coords, zoom } = countryZoom[selectedCountry];
                map.setView(coords, zoom); // Set the map view to the country's coordinates and zoom level
            }
        }

        // Handle dropdown change event
        const countryDropdown = document.getElementById('countryDropdown');
        countryDropdown.onchange = function () {
            const selectedCountry = countryDropdown.value;
            updateMap(selectedCountry); // Update map with the selected country
        };

        // Initialize with a default country (e.g., Sudan)
        updateMap('Sudan'); // Call this to show businesses in Sudan initially
    </script>
</body>
</html>
